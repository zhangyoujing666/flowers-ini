<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ğŸ¦€ Flower Minimal</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: auto; /* å…è®¸æ°´å¹³æ»šåŠ¨ */
        }
        .container {
            background: white;
            max-width: 100%; /*600px;*/
            min-width: 200px; /* è®¾ç½®æœ€å°å®½åº¦ç¡®ä¿å†…å®¹æ˜¾ç¤º */
            margin: 0 auto;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .buttons {
            margin: 20px 0;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 5px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }
        button:hover {
            background: #45a049;
            transform: translateY(-2px);
        }
        #output {
             background: #000000; /*f8f9fa  !important*/
           // background-color: #000000 !important; /* çº¯é»‘ */
            color: #ff69b4;
            /* font-size: 8px; æ‰‹æœºç«¯æ›´å°å­—ä½“ */
            overflow-x: auto; /* overflow: auto å…³é”®ï¼šå…è®¸æ°´å¹³æ»šåŠ¨ */
            overflow-y: auto; /* åŒæ—¶æ”¯æŒæ°´å¹³å’Œå‚ç›´æ»šåŠ¨ */
            -webkit-overflow-scrolling: touch; /*  iOSå¹³æ»‘æ»šåŠ¨ */
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            min-height: 100px;
            overflow: auto;
            min-width: 200px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            text-align: left;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success { background: #d4edda; color: #155724; }
        .loading { background: #fff3cd; color: #856404; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¦€ Flower Demo</h1>
        <p>è‡ªåŠ¨åŒ–æ„å»ºæ¼”ç¤º</p>

        <div class="status loading" id="status">â³ åŠ è½½ FLOWER æ¨¡å—...</div>

        <div class="buttons">
            <button onclick="callGreet()">ğŸ‘‹ æ‰“æ‹›å‘¼</button>
            <button onclick="callAdd()">ğŸ§® è®¡ç®—åŠ æ³•</button>
            <button onclick="showRose()">ğŸŒ¹ æ˜¾ç¤ºç«ç‘°</button>
            <button onclick="testCallback()">ğŸŒ¹ å›è°ƒç«ç‘° </button>
            <button onclick="clearOutput()">ğŸ—‘ï¸ æ¸…ç©º/æ¢è‰²</button>
            <button onclick="callMultiAdd()">ğŸ”¢ å¾ªç¯ç¼©æ”¾ </button>
        </div>

        <div id="output">ç‚¹å‡»æŒ‰é’®æµ‹è¯• FLOWER åŠŸèƒ½</div>
    </div>

    <script type="module">
        // æ­£ç¡®å¯¼å…¥æ‰€æœ‰å‡½æ•°
        import init, { greet, add, add_three, get_rose, print_rose_line_by_line } from './docs/flowers.js';

        let flowerReady = false;
        let flowerFunctions = {};

        // é¢œè‰²åºåˆ—ï¼ˆæŒ‰é¡ºåºè½®è¯¢ï¼‰
        const colorSequence = [
            { code: '#ff69b4', name: 'çƒ­ç²‰è‰²' },
            { code: '#ff1493', name: 'æ·±ç²‰è‰²' },
            { code: '#c71585', name: 'ç´«çº¢è‰²' },
            { code: '#db7093', name: 'æµ…ç´«çº¢' },
            { code: '#ffc0cb', name: 'ç²‰è‰²' },
            { code: '#ffb6c1', name: 'æµ…ç²‰è‰²' },
            { code: '#00ff88', name: 'é’ç»¿è‰²' },
            { code: '#ffff00', name: 'é»„è‰²' },
            { code: '#ff4444', name: 'çº¢è‰²' },
            { code: '#FFFF00', name: 'æ©™è‰²' },
            { code: '#00ffff', name: 'é’è‰²' }
        ];
        // å­—ä½“å¤§å°ï¼ˆæŒ‰é¡ºåºè½®è¯¢ï¼‰
        const fontSequence = [
            { code: '1px', name: '1' },
            { code: '2px', name: '2' },
            { code: '3px', name: '3' },
            { code: '4px', name: '4' },
            { code: '8px', name: '5' },
            { code: '10px', name: '6' },
            { code: '12px', name: '7' },
            { code: '14px', name: '8' },
            { code: '17px', name: '9' },
            { code: '20px', name: '10' }
        ];

        let currentColorIndex = 0;
        let currentFontIndex = 0;

        async function initializeFlower() {
            try {
                const status = document.getElementById('status');
                status.textContent = "â³ æ­£åœ¨åˆå§‹åŒ– FLOWER...";

                // åˆå§‹åŒ– FLOWER
                await init();

                // ä¿å­˜å‡½æ•°å¼•ç”¨
                flowerFunctions = {
                    greet: greet,
                    add: add,
                    add_three: add_three,
                    get_rose: get_rose,
                    print_rose_line_by_line: print_rose_line_by_line
                };

                flowerReady = true;

                status.className = "status success";
                status.textContent = "âœ… FLOWER æ¨¡å—åŠ è½½æˆåŠŸï¼";

                // è‡ªåŠ¨æµ‹è¯•
                setTimeout(() => {
                    document.getElementById('output').textContent =
                        flowerFunctions.greet('è‡ªåŠ¨æµ‹è¯•') + '\n' +
                        'è®¡ç®—æµ‹è¯•: 10 + 20 = ' + flowerFunctions.add(10, 20) + '\n' +
                        'ä¸‰æ•°ç›¸åŠ : 1 + 2 + 3 = ' + flowerFunctions.add_three(1, 2, 3);
                }, 500);

            } catch (error) {
                document.getElementById('status').className = "status error";
                document.getElementById('status').textContent = "âŒ åŠ è½½å¤±è´¥: " + error.message;
                console.error('FLOWER åŠ è½½é”™è¯¯:', error);
            }
        }

        // å…¨å±€å‡½æ•°å®šä¹‰
        window.callGreet = function() {
            if (!flowerReady) {
                alert('FLOWER æ¨¡å—å°šæœªåŠ è½½å®Œæˆï¼Œè¯·ç¨åé‡è¯•');
                return;
            }
            const name = prompt('è¯·è¾“å…¥ä½ çš„åå­—:', 'rose çˆ±å¥½è€…');
            if (name) {
                const result = flowerFunctions.greet(name);
                document.getElementById('output').textContent = result;
            }
        };

        window.callAdd = function() {
            if (!flowerReady) {
                alert('FLOWER æ¨¡å—å°šæœªåŠ è½½å®Œæˆï¼Œè¯·ç¨åé‡è¯•');
                return;
            }
            const a = parseInt(prompt('ç¬¬ä¸€ä¸ªæ•°å­—:', '15')) || 15;
            const b = parseInt(prompt('ç¬¬äºŒä¸ªæ•°å­—:', '25')) || 25;
            const result = flowerFunctions.add(a, b);
            document.getElementById('output').textContent =
                `ğŸ§® è®¡ç®—ç»“æœ: ${a} + ${b} = ${result}`;
        };

        window.callMultiAdd = function() {
            /*
             if (!flowerReady) {
                 alert('FLOWER æ¨¡å—å°šæœªåŠ è½½å®Œæˆï¼Œè¯·ç¨åé‡è¯•');
                 return;
             }
             const result = flowerFunctions.add_three(5, 10, 15);
             document.getElementById('output').textContent =
                 `ğŸ”¢ ä¸‰æ•°ç›¸åŠ : 5 + 10 + 15 = ${result}`;

            */
            currentFontIndex = (currentFontIndex + 1) % fontSequence.length;
            const fontColor = fontSequence[currentFontIndex];
            const output = document.getElementById('output');

            // è®¾ç½®æ–‡å­—
            output.style.fontSize = fontColor.code;

        };

        window.showRose = function() {
            if (!flowerReady) {
                alert('FLOWER æ¨¡å—å°šæœªåŠ è½½å®Œæˆï¼Œè¯·ç¨åé‡è¯•');
                return;
            }
            const rose = flowerFunctions.get_rose();
            document.getElementById('output').textContent = rose;
        };

        // åº”ç”¨å½“å‰é¢œè‰²
        function changeColor() {
            currentColorIndex = (currentColorIndex + 1) % colorSequence.length;
            const currentColor = colorSequence[currentColorIndex];
            const output = document.getElementById('output');

            // è®¾ç½®æ–‡å­—é¢œè‰²
            output.style.color = currentColor.code;

            // æ›´æ–°æ˜¾ç¤º
            /*document.getElementById('currentColor').textContent =
                `${currentColor.name} (${currentColor.code})`;
            document.getElementById('currentColor').style.color = currentColor.code;
            */
        }

        window.clearOutput = function() {
            changeColor();
            // document.getElementById('output').textContent = 'è¾“å‡ºå·²æ¸…ç©º';
        };

        function testLineByLine() {
            if (!flowerReady) {
                alert("è¯·å…ˆåˆå§‹åŒ–FLOWER");
                return;
            }

            const output = document.getElementById('output');
            output.textContent = "ğŸš€ å¼€å§‹è¾“å‡º...\n"; // é€è¡Œ

            // è®¾ç½®å›è°ƒå‡½æ•°
            const callback = function(line) {
                output.textContent += line;
                // + "\n";
                output.scrollTop = output.scrollHeight;
                output.scrollLeft = output.scrollWidth;
            };

            flowerFunctions.print_rose_line_by_line(callback);
        }
        window.testCallback = testLineByLine;

        // é¡µé¢åŠ è½½æ—¶ç«‹å³åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', initializeFlower);
    </script>
</body>
</html>
